<!DOCTYPE html>
<html>
<meta charset='UTF-8' />
<meta name='viewport' content='width=device-width, initial-scale=1' />
<title>3dtiles功能示例 - 加载倾斜摄影数据</title>
<style type='text/css'>
    html,
    body {
        margin: 0px;
        height: 100%;
        width: 100%;
    }

    .container {
        width: 100%;
        height: 100%;
        /* background-color: black; */
    }
</style>
<link rel='stylesheet' href='./../assets/lib/maptalks/maptalks.css' />

<script type='text/javascript' src='./../assets/lib/maptalks/maptalks-gl.js'></script>
<script type='text/javascript' src='./../assets/lib/maptalks.tileclip.js'></script>

<body>
    <!-- <script type="text/javascript" src="https://maptalks.com/api/transcoders.draco.js"></script> -->
    <!-- <button onclick="test()">update road visible</button> -->
    <div id="map" class="container"></div>

    <script>
        const tileActor = maptalks.getTileActor();
        const map = new maptalks.Map("map", {
            "center": [121.48130748990341, 31.181899201199773], "zoom": 15.522397459912927, "pitch": 62.400000000000205, "bearing": -1.910073863921184,
            centerCross: true,
            // spatialReference: {
            //     projection: 'EPSG:4326'
            // },
        });



        map.on('click', e => {
            console.log(e.coordinate.toArray());
        });

        const baseLayer = new maptalks.TileLayer("base", {
            // debug: true,
            urlTemplate: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
            subdomains: ["a", "b", "c", "d"],
            maxAvailableZoom: 18,

            // spatialReference: {
            //     projection: 'EPSG:3857'
            // },
        });

        const groupGLLayer = new maptalks.GroupGLLayer("gl", [baseLayer], {

        }).addTo(map);


        const style = [
            {
                name: 'building-floors',
                filter: ["all",
                    ["==", "$type", "Point"],
                ],
                renderPlugin: {
                    type: "text",
                    dataConfig: {
                        type: "point",
                    },
                    sceneConfig: {}
                },
                symbol: {
                    textName: '{name}',
                    textFaceName: 'fangzheng',
                    textFill: 'yellow',
                    textSize: 22,
                    textHaloFill: '#000',
                    textHaloRadius: 4
                }
            },

        ];
        const vtLayer = new maptalks.GeoJSONVectorTileLayer("vt", {
            workerGlyph: false,
            sdfURL: "./../assets/fonts/{fontstack}/{range}.pbf",
            style,
            debug: true,
            // debugTileData: true,
            data: './../assets/data/shanghai-poi.geojson'
        });


        groupGLLayer.addLayer(vtLayer);













    </script>
</body>

</html>